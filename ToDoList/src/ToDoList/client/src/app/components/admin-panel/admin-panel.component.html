<div class="container mt-4">
  <h2>User Management</h2>

  <ngx-spinner bdColor="rgba(0, 0, 0, 0.6)" size="medium" color="#fff" type="ball-spin-clockwise"></ngx-spinner>

  <!-- Cards -->
  <div class="row row-cols-1 row-cols-md-2 g-4" *ngIf="users.length > 0">
    <div class="col" *ngFor="let user of users">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">
            {{ user.firstName }} {{ user.lastName }}
            <span class="badge bg-primary ms-2">
              {{ UserRoleModel[user.role] }}
            </span>
          </h5>
          <p class="card-text mb-1"><strong>Username:</strong> {{ user.userName }}</p>
          <p class="card-text mb-1"><strong>Email:</strong> {{ user.email }}</p>
          <p class="card-text mb-1"><strong>Phone:</strong> {{ user.phoneNumber }}</p>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <button class="btn btn-outline-primary btn-sm me-2" (click)="openSetRoleModal(user)">
            Change role
          </button>
          <button class="btn btn-outline-danger btn-sm" (click)="openDeleteModal(user)">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>


  <!-- <div class="row row-cols-1 row-cols-md-2 g-4" *ngIf="users.length > 0">
    <div class="col" *ngFor="let user of users">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">
            {{ user.firstName }} {{ user.lastName }}
            <span class="badge bg-primary ms-2">
              {{ UserRoleModel[user.role] }}
            </span>
          </h5>
          <p class="card-text mb-1"><strong>Username:</strong> {{ user.userName }}</p>
          <p class="card-text mb-1"><strong>Email:</strong> {{ user.email }}</p>
          <p class="card-text mb-1"><strong>Phone:</strong> {{ user.phoneNumber }}</p>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <button class="btn btn-outline-primary btn-sm me-2">Change role</button>
          <button class="btn btn-outline-danger btn-sm" (click)="openDeleteModal(user)">Delete</button>
        </div>
      </div>
    </div>
  </div> -->



  <!-- <div class="row row-cols-1 row-cols-md-2 g-4" *ngIf="users.length > 0">
    <div class="col" *ngFor="let user of users">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">
            {{ user.firstName }} {{ user.lastName }}
            <span class="badge bg-primary ms-2">{{ user.role }}</span>
          </h5>
          <p class="card-text mb-1"><strong>Username:</strong> {{ user.userName }}</p>
          <p class="card-text mb-1"><strong>Email:</strong> {{ user.email }}</p>
          <p class="card-text mb-1"><strong>Phone:</strong> {{ user.phoneNumber }}</p>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <button class="btn btn-outline-primary btn-sm me-2" >Change role</button>
          <button class="btn btn-outline-danger btn-sm" (click)="openDeleteModal(user)">Delete</button>
        </div>
      </div>
    </div>
  </div> -->

  <!-- No Users -->
  <div *ngIf="!users.length" class="mt-3 text-center">
    <p>No users found.</p>
  </div>
</div>


<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Confirm Delete</h5>
        <button type="button" class="btn-close" (click)="cancelDelete()"></button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete <strong>{{ userToDelete?.userName }}</strong>?</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary me-2" (click)="cancelDelete()">Cancel</button>
        <button class="btn btn-danger" (click)="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>
</div>

<div class="modal-backdrop" *ngIf="showSetRoleModal">
  <div class="modal-dialog">
    <div class="modal-content">

      <!-- Header -->
      <div class="modal-header">
        <h5 class="modal-title">Change Role</h5>
        <button type="button" class="btn-close" (click)="cancelSetRoleModal()"></button>
      </div>

      <!-- Body -->
      <div class="modal-body">
        <p>
          Are you sure you want to change the role of
          <strong>{{ userToSetRole?.userName }}</strong>?
        </p>

        <div *ngFor="let role of roleOptions">
          <label class="form-check-label">
            <input
              type="radio"
              class="form-check-input"
              name="selectedRole"
              [value]="role.value"
              [(ngModel)]="selectedRole"
            />
            {{ role.label }}
          </label>
        </div>
      </div>

      <!-- Footer -->
      <div class="modal-footer">
        <button class="btn btn-secondary me-2" (click)="cancelSetRoleModal()">Cancel</button>
        <button class="btn btn-primary" (click)="setRole()">Set Role</button>
      </div>

    </div>
  </div>
</div>
